<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.66.0" />
  
  
  
  <title>
    
    xkyle.com
    
  </title>
  <link rel="canonical" href="../../">
  
  <link rel="alternate" type="application/rss+xml" href="../../index.xml" title="xkyle.com">
  
  
  
  
  
  
  



































































  
  <link rel="stylesheet" href="../../css/base.min.50883c9e7cc6f561db1dcd2089b6b895c60df8d10b9e71a90cbc10e59c8bfc40.css" integrity="sha256-UIg8nnzG9WHbHc0giba4lcYN&#43;NELnnGpDLwQ5ZyL/EA=" crossorigin="anonymous">
  
  
</head>
<body>
  <nav class="u-background">
  <div class="u-wrapper">
    <ul class="Banner">
      <li class="Banner-item Banner-item--title">
        <a class="Banner-link u-clickable" href="">xkyle.com</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="about/">About</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="post/">Posts</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="tags/">Tags</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="categories/">Categories</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="index.xml">RSS</a>
      </li>
      
    </ul>
  </div>
</nav>

  <main>
    <div class="u-wrapper">
      <div class="u-padding">
        



<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../sensu-reports-in-your-motd-with-puppet/" rel="bookmark">Sensu Reports in your Motd with Puppet!</a>
  </h2>
  
  <time datetime="2013-11-30T00:19:24Z">
    30 November, 2013
  </time>
  
</header>

  
  <h2 id="intro">Intro</h2>
<p><a href="http://sensuapp.org/">Sensu</a> is a pretty cool monitoring framework. The authors designed it to be configured by a configuration management system from the beginning. Check out how easily I can make it put a report in my motd with a little bit of python and puppet.</p>
<h2 id="the-report-script">The Report Script</h2>
<p>Sensu&rsquo;s API is super easy to work with. For this I will be using the <a href="http://sensuapp.org/docs/0.12/api-events">Events</a> endpoint. Here is a quick script to get the events for a host (<a href="https://gist.github.com/solarkennedy/7713642">gist</a>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python2</span>
<span style="color:#f92672">import</span> json<span style="color:#f92672">,</span>sys<span style="color:#f92672">,</span>urllib2<span style="color:#f92672">,</span>socket

GREEN <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[92m&#39;</span>
RED <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[91m&#39;</span>
CLEAR <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\033</span><span style="color:#e6db74">[0m&#39;</span>

<span style="color:#f92672">from</span> optparse <span style="color:#f92672">import</span> OptionParser
parser <span style="color:#f92672">=</span> OptionParser()
parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-s&#34;</span>, <span style="color:#e6db74">&#34;--server&#34;</span>, dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;server&#34;</span>,
                  help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sensu api server hostname&#34;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sensu&#39;</span>)
parser<span style="color:#f92672">.</span>add_option(<span style="color:#e6db74">&#34;-p&#34;</span>, <span style="color:#e6db74">&#34;--port&#34;</span>, dest<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;port&#34;</span>,
                  help<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sensu server api port&#34;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;4567&#39;</span>)
(options, args) <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()

response <span style="color:#f92672">=</span> urllib2<span style="color:#f92672">.</span>urlopen(<span style="color:#e6db74">&#39;http://&#39;</span> <span style="color:#f92672">+</span> options<span style="color:#f92672">.</span>server <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;:&#39;</span> <span style="color:#f92672">+</span> options<span style="color:#f92672">.</span>port <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/events/&#39;</span> <span style="color:#f92672">+</span> socket<span style="color:#f92672">.</span>getfqdn())
data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(response)
<span style="color:#66d9ef">print</span>
<span style="color:#66d9ef">if</span> len(data) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
  <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Failed Sensu checks on this host:&#34;</span>
  <span style="color:#66d9ef">for</span> entry <span style="color:#f92672">in</span> data:
      sys<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;   &#34;</span> <span style="color:#f92672">+</span> RED <span style="color:#f92672">+</span> entry[<span style="color:#e6db74">&#39;check&#39;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;: &#39;</span> <span style="color:#f92672">+</span> entry[<span style="color:#e6db74">&#39;output&#39;</span>] <span style="color:#f92672">+</span> CLEAR )
<span style="color:#66d9ef">else</span>: 
  <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;All Sensu checks &#34;</span> <span style="color:#f92672">+</span> GREEN <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;green &#34;</span> <span style="color:#f92672">+</span> CLEAR <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;for this host.&#34;</span>
<span style="color:#66d9ef">print</span>
</code></pre></div><h2 id="puppet-glue"> Puppet Glue</h2>
<p>{% codeblock lang:ruby %}
file { &lsquo;/usr/bin/sensu_report&rsquo;:
mode   =&gt; &lsquo;0555&rsquo;,
source =&gt; &lsquo;puppet:///files/sensu/sensu_report&rsquo;,
} -&gt;
cron { &lsquo;sensu_report&rsquo;:
command =&gt; &ldquo;/usr/bin/sensu_report -s $sensu_api_server &gt; /etc/motd&rdquo;,
minute  =&gt; fqdn_rand(60),
} -&gt;
sensu::check { &ldquo;sensu_report&rdquo;:
handlers    =&gt; &lsquo;default&rsquo;,
command     =&gt; &lsquo;/usr/lib/nagios/plugins/check_file_age -w 7200 -c 21600 -f /etc/motd&rsquo;,
subscribers =&gt; &lsquo;sensu-test&rsquo;
}
{% endcodeblock %}</p>
<p>You can see that there are three things going on here (gist <a href="https://gist.github.com/solarkennedy/7713642">here</a>):</p>
<ol>
<li>Puppet drops in the python report script <strong>file</strong>.</li>
<li>Only if the script is in place, it will setup the <strong>cronjob</strong> to populate the motd</li>
<li>And only if the cron job is in place, a <strong>sensu check</strong> is installed to verify that it is indeed working (test driven system administration?).</li>
</ol>
<p><a href="../../uploads/sensu_motd.png"><img src="../../uploads/sensu_motd.png" alt="sensu_motd"></a></p>
<h2 id="coolness">Coolness</h2>
<ul>
<li> Puppet and Sensu make it easy to construct things like this. Wiring something like this manually with nagios would be a pain.</li>
<li>Adding failed checks right in the MTOD increases visibility for them, while decreasing the brain overload of looking a huge sensu dashboard with tons of red that a random user may not care about.</li>
<li>Putting checks in the MOTD makes it easy to disseminate information about what might be down on a host, to minimize support requests and increase transparency.</li>
</ul>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Puppet/" rel="tag">Puppet</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/sensu/" rel="tag">sensu</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../managing-dns-automatically-with-puppet/" rel="bookmark">Managing DNS Automatically with Puppet</a>
  </h2>
  
  <time datetime="2013-10-19T23:05:02Z">
    19 October, 2013
  </time>
  
</header>

  
  <h1 id="why">Why</h1>
<p>So you have a decent amount of things configured in Puppet. Great!</p>
<p>Are you finding that you have to manually update your DNS entries when things change, like when new hosts or added, or additional services are created?</p>
<p>Why? Your DNS zone files will forever be out of date, waiting for humans to update them. Just say no. Puppet already knows what the ip addresses and hostnames of your servers, why not take advantage of that existing data?</p>
<h1 id="how">How</h1>
<p>Most of the credit for this has to go do <a href="https://github.com/ajjahn">Adam Jahn</a> for his <a href="https://github.com/ajjahn/puppet-dns">original work</a>. But there is a lot of work to be done and many outstanding pull requests. Until things are more unified, I&rsquo;m going to recommend installing my version of the module:</p>
<pre><code>puppet module install KyleAnderson/dns
</code></pre>
<p>Once the module is installed, you can setup bind on your nameserver:</p>
<pre><code>node 'ns1.example.com' {
  include dns::server
  ...
</code></pre>
<p>Warning: Don&rsquo;t try to use this on top of an existing configuration, Puppet will take control and break your existing stuff.</p>
<p>You can also create zones, right from puppet:</p>
<pre><code> dns::zone { 'example.com':
    soa         =&gt; $::fqdn,
    soa_email   =&gt; &quot;admin.${::domain}&quot;,
    nameservers =&gt; [&quot;${::hostname&quot;]
  }
</code></pre>
<p>Now you can add A records:</p>
<pre><code>dns::record::a { $hostname:
   zone =&gt; 'example.com',
   data =&gt; $::ipaddress, 
}
</code></pre>
<h1 id="going-further">Going Further</h1>
<p>Using the <a href="http://docs.puppetlabs.com/guides/exported_resources.html">exported resources pattern</a> and stored configs with say, <a href="https://docs.puppetlabs.com/puppetdb/latest/">PuppetDB</a>, you can create records on different hosts and then collect them on your name server. For example:</p>
<pre><code>node 'mycoolserver.example.com' {
  @@dns::record::a { $hostname: zone =&gt; $::domain, data =&gt; $::ipaddress, }
}

node 'ns1.example.com' {
  dns::zone { $::domain:
    soa         =&gt; $::fqdn,
    soa_email   =&gt; &quot;admin.${::domain}&quot;,
    nameservers =&gt; [ 'ns1' ],
  }
  # Collect all the records from other nodes
  Dns::Record::A &lt;&lt;||&gt;&gt;
}
</code></pre>
<p>In this example, an A record was requested on the mycoolserver node, but it could have been included on any class that includes lots of servers. In the end they show up on the ns1.example.com node with the &laquo;||&raquo; operator.</p>
<h1 id="other-possibilities">Other Possibilities</h1>
<ul>
<li>
<p>Have your <a href="https://forge.puppetlabs.com/puppetlabs/haproxy">HAProxy</a> or <a href="https://forge.puppetlabs.com/puppetlabs/f5">F5 load balancer</a> configs automatically generate the new CNAMEs and A records they need to operate.</p>
</li>
<li>
<p>Setup your <a href="https://github.com/puppetlabs/puppetlabs-apache#configure-a-virtual-host">Apache vhosts</a> to automatically point to the right server.</p>
</li>
<li>
<p>Never have to remember to update IPMI addresses by using the combining this with the <a href="https://github.com/logicminds/bmclib">BMCLib</a> module.</p>
</li>
<li>
<p>Setup new hosts in <a href="https://forge.puppetlabs.com/zleslie/dhcp">DHCP</a>, and have them automatically get an A record to go with them.</p>
</li>
<li>
<p>Have <a href="http://forge.puppetlabs.com/puppetlabs/ntp">NTP</a> servers? Did you remember to update their DNS records? Oh wait, puppet does that for you.</p>
</li>
</ul>
<h1 id="future-work">Future Work</h1>
<p>I will continue to send my pull requests and maintaining my own fork. <a href="https://github.com/solarkennedy/puppet-dns">Join the fun</a>!</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/dns/" rel="tag">dns</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Puppet/" rel="tag">Puppet</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/puppetdb/" rel="tag">puppetdb</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/stored-configs/" rel="tag">stored configs</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../getting-started-with-sensu-using-puppet-for-real/" rel="bookmark">Getting Started With Sensu Using Puppet. For Real. </a>
  </h2>
  
  <time datetime="2013-10-13T01:55:41Z">
    13 October, 2013
  </time>
  
</header>

  
  <p>Nagios. So familiar. I feel like I&rsquo;ve run Nagios at every job I have ever had.</p>
<p>Talk to most ops people, even at really big places, and they will probably admit
to using it.</p>
<p>Puppet&rsquo;s <a href="http://docs.puppetlabs.com/guides/exported_resources.html">exported resources</a>
takes away some of the pain, but sometimes I think to myself, there must be a
better way to do this. <a href="http://sensuapp.org/">Sensu</a> might be that better way.</p>
<p>Let&rsquo;s try it out, but gosh, I am SO lazy. I cannot be bothered to read the
installation instructions. All I want to do is install the puppet module,
add a couple of lines to my manifest, and let puppet do the rest. Then I
can run puppet agent in debug mode so when my boss comes by it looks like
I&rsquo;m REALLY busy.</p>
<h1 id="sensu_logouploadssensu_logo_large-300x260pnguploadssensu_logo_largepng"><a href="../../uploads/sensu_logo_large.png"><img src="../../uploads/sensu_logo_large-300x260.png" alt="sensu\_logo"></a></h1>
<h2 id="step-1-game-plan">Step 1: Game plan</h2>
<p>I&rsquo;ve got a test server I know I want to be my sensu server. I know I&rsquo;m going to
have enable the sensu client run on the servers I want monitored. Here are my
goals:</p>
<ul>
<li>Have <strong>sensu-server</strong> configured on my server (call it <code>mon1</code>)</li>
<li>Have <strong>sensu-client</strong> configured on my client (call it <code>client1</code>)</li>
<li>I want a <strong>dashboard</strong></li>
<li>I want a an <strong>email alert</strong></li>
<li>I <strong>don&rsquo;t</strong> want to have to ssh to my clients to do anything. (I have puppet to do that for me, duh.)</li>
</ul>
<h2 id="step-2-puppet-module">Step 2: Puppet Module</h2>
<p>My puppet master is not <code>mon1</code>, but it doesn&rsquo;t matter. I run on the puppetmaster</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    puppet module install example42/redis
    puppet module install puppetlabs/rabbitmq
    puppet module install sensu/sensu
</code></pre></div><p>Ok, good start. So&hellip;  the &ldquo;For Real&rdquo; part in the blog post title is about those
<em>other</em> things that most howto&rsquo;s don&rsquo;t mention. Unless you already have
RabbitMQ and Redis installed, you will need those modules. Don&rsquo;t know how to
run Redis or configure RabbitMQ? It&rsquo;s ok, neither do I.</p>
<h2 id="step-2a-ssl-certs">Step 2A: SSL Certs</h2>
<p>Yea, I know what you are thinking. Kyle, I already have SSL certs for my
infrastructure, do I have make another set? Yes. I think so. I&rsquo;m not smart
enough to use existing certs.</p>
<p>Joe Miller has made a pretty easy script to generate some. For RabbitMQ
you can basically use a single client and server key and let puppet distribute them:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    git clone git://github.com/joemiller/joemiller.me-intro-to-sensu.git
    cd joemiller.me-intro-to-sensu
    ./ssl_certs.sh generate
    mkdir -p /etc/puppet//files/sensu/
    cp *.pem testca/*.pem /etc/puppet/files/sensu/
</code></pre></div><p>You  can see that I just stick all the files in my &ldquo;files/sensu&rdquo; directory
for puppet to distribute for me.</p>
<h2 id="step-2b-puppet-config">Step 2B: Puppet config</h2>
<p>Here is the configuration I needed to get a full system running:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    node mon1 {
      file { <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl/server_key.pem&#39;</span>:
        source <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;puppet:///files/sensu/server_key.pem&#39;</span>,
      }
      file { <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl/server_cert.pem&#39;</span>:
        source <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;puppet:///files/sensu/server_cert.pem&#39;</span>,
      }
      file { <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl/cacert.pem&#39;</span>:
        source <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;puppet:///files/sensu/cacert.pem&#39;</span>,
      }
      <span style="color:#66d9ef">class</span> { <span style="color:#e6db74">&#39;rabbitmq&#39;</span>:
        ssl_key <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl//server_key.pem&#39;</span>,
        ssl_cert <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl//server_cert.pem&#39;</span>,
        ssl_cacert <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;/etc/rabbitmq/ssl//cacert.pem&#39;</span>,
        ssl <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">true</span>,
      }
      rabbitmq_vhost { <span style="color:#e6db74">&#39;/sensu&#39;</span>: }
      rabbitmq_user { <span style="color:#e6db74">&#39;sensu&#39;</span>: password <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;password&#39;</span> }
      rabbitmq_user_permissions { <span style="color:#e6db74">&#39;sensu@/sensu&#39;</span>:
        configure_permission <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;.*&#39;</span>,
        read_permission <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;.*&#39;</span>,
        write_permission <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;.*&#39;</span>,
      }
      <span style="color:#66d9ef">class</span> {<span style="color:#e6db74">&#39;redis&#39;</span>: }
      <span style="color:#66d9ef">class</span> {<span style="color:#e6db74">&#39;sensu&#39;</span>:
        server <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">true</span>,
        purge_config <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">true</span>,
        rabbitmq_password <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;password&#39;</span>,
        rabbitmq_ssl_private_key <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;puppet:///files/sensu/client_key.pem&#34;</span>,
        rabbitmq_ssl_cert_chain <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;puppet:///files/sensu/client_cert.pem&#34;</span>,
        rabbitmq_host <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mon1&#39;</span>,
        subscriptions <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;sensu-test&#39;</span>,
      }
    }
</code></pre></div><p>Take note that the Sensu module lets you stick in a puppet:/// url for the
certs, but the RabbitMQ module does not. Distributing them using the &ldquo;file&rdquo;
directive is pretty easy though.</p>
<p>I personally believe that <strong>purge_config</strong> should default to true. We are using
puppet here. If you are hand placing json, you are doing it wrong.</p>
<h1 id="step-3-clients">Step 3: Clients</h1>
<p>With your SSL certs in place, adding clients is pretty easy:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    node client1 {
      <span style="color:#66d9ef">class</span> { <span style="color:#e6db74">&#39;sensu&#39;</span>:
        purge_config <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">true</span>,
        rabbitmq_password <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;password&#39;</span>, 
        rabbitmq_host <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mon1&#39;</span>,
        subscriptions <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;sensu-test&#39;</span>,
        rabbitmq_ssl_private_key <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;puppet:///files/sensu/client_key.pem&#34;</span>,
        rabbitmq_ssl_cert_chain <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;puppet:///files/sensu/client_cert.pem&#34;</span>, 
      }
    }
</code></pre></div><p>Not too bad. Notice that there is nothing server-side to generate the config
for this host.</p>
<p>After your puppet runs converge, you should be able to access the Sensu
dashboard. By default it is on the sensu server, in this example it would be
<a href="http://sensu:secret@mon1:8080">http://sensu:secret@mon1:8080</a>.</p>
<p>If all of this is working, you should see client1 in the clients list.</p>
<h1 id="step-4-handlers">Step 4: Handlers</h1>
<p>Sensu <a href="http://docs.sensuapp.org/0.11/handlers.html">handlers</a> are scripts
that are called with event data. For getting started I use the simplest example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    sensu<span style="color:#f92672">::</span>handler { <span style="color:#e6db74">&#39;default&#39;</span>:
      command <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mail -s &#34;sensu alert&#34; kyle@xkyle.com&#39;</span>,
    }
</code></pre></div><p>You are going to get json in your body, but we can make it pretty later.</p>
<h2 id="step-5a-your-first-client-side-check">Step 5A: Your first client-side check</h2>
<p>This type of check is what you might consider an NRPE check, it runs on the client:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    node client1 {
    <span style="color:#f92672">...</span>
      package { <span style="color:#e6db74">&#39;nagios-plugins-basic&#39;</span>: <span style="color:#66d9ef">ensure</span> <span style="color:#f92672">=&gt;</span> latest } 
      sensu<span style="color:#f92672">::</span>check { <span style="color:#e6db74">&#34;cron&#34;</span>:
        handlers    <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;default&#39;</span>,
        command     <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;/usr/lib/nagios/plugins/check_procs -C cron -c 1:10&#39;</span>,
        subscribers <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;sensu-test&#39;</span>
      }
</code></pre></div><p>Run puppet, stop cron, you should get an email.</p>
<h2 id="step-5b-your-first-server-side-check">Step 5B: Your first server-side check</h2>
<p>Sometimes you need to have the servers do the checking. Not everything can be
a client-side check. Sometimes you really do want your monitor server to be
able to ping your clients (or check http, etc).</p>
<p>The Sensu documentation doesn&rsquo;t seem to have examples of this. The only way
I know how to do it is with <a href="http://docs.puppetlabs.com/guides/exported_resources.html">stored configs</a>
 with something like
<a href="http://docs.puppetlabs.com/guides/exported_resources.html">puppetdb</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">    node client1 {
    <span style="color:#f92672">...</span>
    @@sensu<span style="color:#f92672">::</span>check { <span style="color:#e6db74">&#34;check-ping-$fqdn&#34;</span>:
        handlers    <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;default&#39;</span>,
        command     <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;/usr/lib/nagios/plugins/check_ping -H $::ipaddress -w 100.0,60% -c 200.0,90% &#34;</span>,
        subscribers <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;sensu-test&#39;</span>
      }
    }
    node mon1 {
    <span style="color:#f92672">...</span>
      <span style="color:#66d9ef">Sensu</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Check</span> <span style="color:#f92672">&lt;&lt;||&gt;&gt;</span>
    }
</code></pre></div><p>In this case, the @@ in front of the sensu check tells puppet to not actually
make it, just store it. Then the &laquo;||&raquo; operator on the server side will take
those stored configs, and make them.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Sensu is still new, but it shows a lot of promise. It is built from the ground
up to be configured by machines, not by humans. It is also designed to scale,
allowing you to grow your RabbitMQ cluster and your Sensu-servers at will.</p>
<p>Absent from Sensu (at the time of this writing) is the infrastructure for
complicated time periods, escalations, etc. Maybe it is better that way? It
does feel a little more unixy, with each individual Sunsu piece handling a
very particular function.</p>
<p>Not mentioned in this post is how to manage subscriptions, making new handlers,
adding <a href="http://docs.sensuapp.org/0.11/mutators.html">mutators</a>, supplementing
the checks with <a href="http://docs.sensuapp.org/0.11/adding_a_metric.html">metrics</a>
and having Sensu handle them by shipping them
<a href="http://docs.sensuapp.org/0.11/adding_a_metric.html">off to a metric system</a>,
<a href="https://github.com/sensu/sensu-admin">sensu-admin</a>, having Sensu automatically
detect <a href="https://github.com/agent462/sensu-handler-awsdecomm">downed AWS nodes and not alert</a>
on them, etc.</p>
<p>In the brave new elastic-compute-config-management-controlled world, Sensu
looks like a lot better option than Nagios in my opinion.</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/nagios/" rel="tag">nagios</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Puppet/" rel="tag">Puppet</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/sensu/" rel="tag">sensu</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../dropbear-with-mosh-on-a-low-end-server/" rel="bookmark">Dropbear with Mosh on a Low End Server</a>
  </h2>
  
  <time datetime="2013-10-03T05:07:55Z">
    3 October, 2013
  </time>
  
</header>

  
  <p>I love my <a href="http://lowendbox.com/">low end boxes</a>. I also love <a href="http://mosh.mit.edu/">mosh</a>.</p>
<p>Low end boxes usually are tight on resources, so Dropbear is often used as a lightweight ssh server. Mosh is mostly tested with openssh-client/server, so I think there are some bugs.</p>
<p>But it can work, just make sure:</p>
<ol>
<li>
<p>You are using the same version of mosh on the <strong>server</strong> as you are on your <strong>client</strong>. (otherwise they may not support the same command line options)</p>
</li>
<li>
<p>Make sure you have have a en_US.UTF-8. Mosh requires UTF8, and low end boxes usually have a bare install without this local. Run:</p>
</li>
</ol>
<pre><code>locale-gen --no-archive en_US.UTF-8
</code></pre>
<p>For a reproducible puppet snipped:</p>
<pre><code>package { 'mosh': ensure =&gt; latest }
ensure_packages(['locales'])
exec { &quot;/usr/sbin/locale-gen --no-archive en_US.UTF-8&quot;:
 creates =&gt; '/usr/lib/locale/en_US.utf8',
}
</code></pre>
<ol start="3">
<li>Run mosh more than once. There is some sort of race condition or bug which prevents mosh from grabbing a tty. Running it multiple times will get it to work eventually. I haven&rsquo;t tracked down the root cause.</li>
</ol>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/dropbear/" rel="tag">dropbear</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/mosh/" rel="tag">mosh</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Puppet/" rel="tag">Puppet</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../goodbye-intel-my-favorite-commands/" rel="bookmark">Goodbye Intel - My Favorite Commands</a>
  </h2>
  
  <time datetime="2013-06-26T02:34:43Z">
    26 June, 2013
  </time>
  
</header>

  
  <p>Working at Intel has been a great experience. I wish I could have stayed longer, but in the end we decided to part ways.</p>
<p>During my stay I learned lots of stuff. I would like to boil my experience down to my top Linux commands.</p>
<h2 id="the-list">The List</h2>
<ul>
<li><a href="http://try.github.com">git</a>: Lots of git.</li>
<li><a href="https://wiki.xkyle.com/Syscfg">syscfg</a>: Managing bios settings from within Linux. Nice. (Intel platforms)</li>
<li><a href="https://wiki.xkyle.com/Dell_setupbios">setupbios</a>: More bios settings from within Linux. (Dell platforms)</li>
<li><a href="https://puppetlabs.com/">puppet</a>: I actually enjoy manually running puppet. &ndash;noop make me feel warm and fuzzy.</li>
<li><a href="http://software.intel.com/en-us/articles/intel-manycore-platform-software-stack-mpss">micctrl</a>: Borking a lot of kernel installs on <a href="https://en.wikipedia.org/wiki/Intel_MIC">mic </a>cards, you end up using this command. Lots.</li>
<li><a href="http://download.intel.com/support/motherboards/server/ism/sb/intel_ofu_user_guide.pdf">flashupdt</a>/<a href="http://flashrom.org/Flashrom">flashrom</a>: Soooo many bios&rsquo; flashed. Intel is bios-crazy.</li>
<li><a href="http://software.intel.com/en-us/intel-vtune-amplifier-xe">amplxe-gui</a>: VTune Amplifier is a super awesome profiling tool. I could spend hours playing around in that gui exploring all programs trying to track down bottlenecks.</li>
<li><a href="../../7-underused-ipmitool-commands/">ipmitool</a>: Everyone needs more ipmitool in their life, totally <a href="../../7-underused-ipmitool-commands/">underrated</a>. Sadly, I would bet most sysadmins don&rsquo;t even know IPMI exists. :(</li>
<li><a href="http://linuxmanpages.com/man8/numactl.8.php">numactl</a>: I&rsquo;m waiting for <a href="http://fedoraproject.org/wiki/Features/numad">numad</a>, personally. My server should be smart enough to understand its own architecture.</li>
</ul>
<h2 id="honorablementions">Honorable Mentions</h2>
<ul>
<li><a href="http://software.intel.com/en-us/intel-compilers/">icc</a>: I didn&rsquo;t run icc many times at Intel, but I was impressed with it.</li>
<li><a href="https://en.wikipedia.org/wiki/Objdump">objdump</a>: The few times I needed to run this, I felt like a wizard.</li>
<li><a href="http://www-03.ibm.com/systems/technicalcomputing/platformcomputing/products/lsf/index.html">bsub</a>: On occasion I was required to submit jobs to LSF.</li>
<li><a href="http://manpages.courier-mta.org/htmlman1/lscpu.1.html">lscpu</a>: I felt like I ran this more than at other companies. Could be just selection bias.</li>
</ul>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/bios/" rel="tag">bios</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/git/" rel="tag">git</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/icc/" rel="tag">icc</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/intel/" rel="tag">intel</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/ipmi/" rel="tag">ipmi</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/ipmitool/" rel="tag">ipmitool</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/linux/" rel="tag">linux</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Puppet/" rel="tag">Puppet</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/syscfg/" rel="tag">syscfg</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../rebuilding-packages-for-arm-or-any-other-arch/" rel="bookmark">Rebuilding Packages for ARM (or any other arch)</a>
  </h2>
  
  <time datetime="2013-06-21T04:46:58Z">
    21 June, 2013
  </time>
  
</header>

  
  <p>Sometimes there are packages out there that don&rsquo;t come in your cool new Architecture. In my case it is ARM, and the package I wanted was Puppet. Here is how to rebuild source packages the cool way.</p>
<h2 id="add-the-puppet-repo-so-you-can-get-fresh-source-packages">Add the Puppet repo so you can get fresh source packages</h2>
<pre><code>cd /tmp
# Add the repo, even though it may not have arm binaries...
wget http://apt.puppetlabs.com/puppetlabs-release-precise.deb 
dpkg -i puppetlabs-release-precise.deb
# Get dependencies...
apt-get update
apt-get build-dep puppet facter
</code></pre>
<h2 id="build--install">Build / Install</h2>
<pre><code># Get sources..
apt-get source facter
cd facter-1.7.1
dpkg-buildpackage
cd /tmp
dpkg -i facter_1.7.1-1puppetlabs1_armhf.deb
</code></pre>
<h2 id="more">More</h2>
<p>Facter is easy. Only one extra missing dependency that you can apt-get.</p>
<p>Next try to build puppet. No problem, except when you try to install it, it depends on Hiera.</p>
<p>Build Hiera, install it, then try puppet again. This process takes a while to build up all the dependencies.</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../an-overdrive-pro-connecting-on-openwrt/" rel="bookmark">An Overdrive Pro Connecting on OpenWrt</a>
  </h2>
  
  <time datetime="2013-05-31T01:45:13Z">
    31 May, 2013
  </time>
  
</header>

  
  <p>Have a fancy <a href="http://www.freedompop.com/">FreedomPop</a> Overdrive Pro? Want to hook it up to your OpenWrt based router to use as a backup (or primary?) internet connection? Lets do it.</p>
<p>Plug it into your router via USB. Then run:</p>
<pre><code>opkg install kmod-usb-net-cdc-ether
</code></pre>
<p>Run dmesg and it will report which eth device came up. Mine shows up as &ldquo;eth1&rdquo;. Now make eth1 your &ldquo;wan&rdquo; interface:</p>
<pre><code>uci set network.wan.ifname=eth1
uci commit
reboot
</code></pre>
<p>Whoa.</p>
<p>Or, set it up as a second wan interface and use <a href="http://wiki.openwrt.org/doc/uci/multiwan">Multiwan</a>:</p>
<pre><code>uci set network.wan2=interface
uci set network.wan2.proto=dhcp
uci set network.wan2.ifname=eth1
uci set network.wan2.dns=8.8.4.4, 8.8.8.8
uci commit
</code></pre>
<p>Alternatively you could add it to your main bridge with a static ip and use it as an alternate gateway on a per-client basis. Or just plug it into a pc. Or just use the built-in wifi of the device itself, but who would want to do that?</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/freedompop/" rel="tag">freedompop</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/openwrt/" rel="tag">openwrt</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../a-team-fortress-2-see-n-say/" rel="bookmark">A Team Fortress 2 See &#39;n Say!</a>
  </h2>
  
  <time datetime="2013-05-18T21:12:21Z">
    18 May, 2013
  </time>
  
</header>

  
  <p>Hopefully Valve will offer me a job instead of suing me? :)</p>
<h2 id="teardown">Teardown</h2>
<h2 id="gallery-ids9919929939949959969991001100210001003997">[gallery ids=&quot;991,992,993,994,995,996,999,1001,1002,1000,1003,997&rdquo;]</h2>
<h2 id="parts">Parts</h2>
<ul>
<li>
<p>Many <a href="http://en.wikipedia.org/wiki/See_'n_Say">See N&rsquo; Says</a> to destroy (I burned through 3)</p>
</li>
<li>
<p>An <a href="http://arduino.cc/en/">Arduino</a> (yes, because I&rsquo;m a lazy noob)</p>
</li>
<li>
<p><a href="http://www.ladyada.net/make/waveshield">Wave shield</a></p>
</li>
<li>
<p>Some sort of ISP programmer</p>
</li>
<li>
<p>Speaker / Switch / Hot-glue / Resistors / etc</p>
</li>
</ul>
<h2 id="how-it-works">How It Works</h2>
<ul>
<li>
<p>A user pulls the handle, activating the normally-open switch and powering the arduino</p>
</li>
<li>
<p>When the handle is released and the spinner starts spinning, a resistor sensor detects at least two succsessive reistor changes, indicating that the spinner is in motion and noting the first value of the resistor for the next step</p>
</li>
<li>
<p>The wave shield plays a prelude for the class, &ldquo;The scout says&hellip;&rdquo; and a random wave file in the &ldquo;Scout&rdquo; folder.</p>
</li>
<li>
<p>By the time the handle gets back to the top, the wave file is over, the spinner stops spinning, and the swich is pushed open again, to power everyhing off and save the batteries.</p>
</li>
</ul>
<h2 id="battery-math">Battery Math</h2>
<ul>
<li>
<p>.09 Amps * 5 Volts = .45 Watts</p>
</li>
<li>
<p>.45 Watts * 6 Seconds per Spin = 2.7 Joules per Spin</p>
</li>
<li>
<p>4 Batteries * 9,000 Joules per Battery = 36,000 Joules</p>
</li>
<li>
<p>36,000 Joules / 2.7 Joules per Spin = 13,333 Spins?</p>
</li>
</ul>
<p>Realistically the batteries will ooze before we run out of juice?</p>
<h2 id="source-code">Source Code</h2>
<p>Source code is on my <a href="https://github.com/solarkennedy/TeamFortress2-SeeNSay">Github</a>. Includes code for extracting sounds from TF2 and Arduino code.</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/arduino/" rel="tag">arduino</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Personal/" rel="tag">Personal</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/See-N-Say/" rel="tag">See N Say</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/Team-Fortress-2/" rel="tag">Team Fortress 2</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../getting-started-with-spdy-on-nginx/" rel="bookmark">Getting Started With SPDY on Nginx</a>
  </h2>
  
  <time datetime="2013-05-12T21:29:09Z">
    12 May, 2013
  </time>
  
</header>

  
  <p><a href="http://en.wikipedia.org/wiki/SPDY">SPDY</a> is a fancy new way to do HTTP, pioneered by Google. Pretty much all modern browsers support it now, except for of course, IE.</p>
<p>If you have SSL enabled and are using nginx, they you are pretty close to running your sites with SPDY. What how easy it is!</p>
<h2 id="step-1-get-a-version-of-nginx-with-spdy-enabled">Step 1: Get a version of nginx with spdy enabled.</h2>
<h3 id="ubuntu">Ubuntu</h3>
<p>Get some <a href="http://nginx.org/en/linux_packages.html">packages</a>. The <strong>Ubuntu</strong> packages have &ldquo;&ndash;with-http_spdy_module&rdquo; compiled, so you can install them with no problem:</p>
<pre><code>cd /tmp
wget http://nginx.org/keys/nginx_signing.key
apt-key add nginx_signing.key
rm nginx_signing.key

echo &quot;deb http://nginx.org/packages/ubuntu/ precise nginx
deb-src http://nginx.org/packages/ubuntu/ precise nginx&quot; &gt; /etc/apt/sources.list.d/nginx.list
apt-get update
apt-get remove nginx
apt-get autoremove
apt-get install nginx
</code></pre>
<h3 id="centos--rhel">Centos / RHEL</h3>
<p>The <strong>Centos</strong> packages need to be rebuilt. And you need a new openssl. (carefully)</p>
<pre><code>yum install yum-utils rpmdevtools
yum-builddep nginx
rpm -i http://nginx.org/packages/centos/6/SRPMS/nginx-1.4.1-1.el6.ngx.src.rpm

cd /tmp
wget http://www.openssl.org/source/openssl-1.0.1e.tar.gz
tar xzf openssl-1.0.1e.tar.gz
</code></pre>
<p>Now add these lines to the two configure commands (one normal, one debug) in the spec file (~/rpmbuild/SPECS/nginx.spec):</p>
<pre><code> --with-http_spdy_module \
 --with-openssl=/tmp/openssl-1.0.1e/ \
</code></pre>
<p>Now build yourself and RPM:</p>
<pre><code>cd ~/rpmbuild/
rpmbuild -ba SPECS/nginx.spec
rpm -e nginx
rpm -Uvh RPMS/i386/nginx-1.4.1-1.el6.ngx.i386.rpm
/etc/init.d/nginx restart
</code></pre>
<h2 id="configuringnginx"> Configuring nginx</h2>
<p>Take your listen line, and add &ldquo;ssl spdy&rdquo; to it:</p>
<pre><code>server {
      listen 443 ssl spdy;
</code></pre>
<h2 id="testing">Testing</h2>
<p>Try this <a href="http://spdycheck.org/#xkyle.com">SPDY testing page</a>.
And try a <a href="https://chrome.google.com/webstore/detail/spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin?hl=en">Chrome plugin</a> that will visually indicate if the server you are talking to supports SPDY.</p>
<p><a href="../../uploads/Screenshot-from-2013-05-16-174759.png"><img src="../../uploads/Screenshot-from-2013-05-16-174759.png" alt="spdy indicator"></a></p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/httpd/" rel="tag">httpd</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/nginx/" rel="tag">nginx</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/SPDY/" rel="tag">SPDY</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../../disabling-microphone-auto-gain-sensitivity-for-google-plus-hangouts/" rel="bookmark">Disabling Microphone Auto-Gain (Sensitivity) For Google Plus Hangouts</a>
  </h2>
  
  <time datetime="2013-04-17T01:14:56Z">
    17 April, 2013
  </time>
  
</header>

  
  <p>Google&rsquo;s Google Plus Hangout / Gtalk plugin automatically adjust your volume to account for varying noise conditions by default. Sometimes this is an undesired behavior, but there is no button to turn it off. Here is how you do it:</p>
<h2 id="linux">Linux:</h2>
<p>Run this in a terminal:</p>
<pre><code>echo &quot;audio-flags=1&quot; &gt; ~/.config/google-googletalkplugin/options
</code></pre>
<h2 id="windows">Windows:</h2>
<p>Set the registry Key:</p>
<pre><code>HKEY_CURRENT_USER\&lt;wbr&gt;&lt;/wbr&gt;Software\Google\Google Talk Plugin\options\audio-flags = 1
</code></pre>
<h2 id="mac-osx">Mac OSX:</h2>
<p>Edit the plist:</p>
<pre><code>~/Library/Preferences/com.&lt;wbr&gt;&lt;/wbr&gt;google.GoogleTalkPluginD.plist
</code></pre>
<p>and set &ldquo;Audio Flags&rdquo; = 1</p>
<h2 id="all">All:</h2>
<p>When you are done, all instances of Chrome must be restarted. Simply closing the windows isn&rsquo;t enough though, reboot to be sure.</p>

  
  






<footer>
  
  
  <ul class="Tags">
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/audio/" rel="tag">audio</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/google/" rel="tag">google</a>
    </li>
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="../../categories/google-plus/" rel="tag">google plus</a>
    </li>
    
    
  </ul>
  
  
  
  
</footer>


</article>
<div class="Divider"></div>


<nav>
  
  <a class="Pagination u-clickable" href="../../page/5/" rel="prev">« Previous</a>
  
  
  <a class="Pagination Pagination--right u-clickable" href="../../page/3/" rel="next">Next »</a>
  
</nav>




      </div>
    </div>
  </main>
  
<footer class="Footer">
  <div class="u-wrapper">
    <div class="u-padding">
      Except where otherwise noted, content on this site is licensed under a a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license"> Creative Commons Attribution 4.0 International License</a>.
    </div>
  </div>
</footer>


</body>
</html>
