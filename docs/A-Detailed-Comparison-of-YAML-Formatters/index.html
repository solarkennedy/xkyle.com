<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.102.3" />
  <meta itemprop="name" content="A Detailed Comparison of YAML Formatters">
<meta itemprop="description" content="This is a survey of the current state of YAML formatters. For this blog post, I&rsquo;m comparing tools that take YAML files on disk and rewrite them to some standard. This is beyond the scope of a normal YAML linter.
If you ask me, all file formats deserve a fmt tool. YAML is not exception, especially as it is not the best. In fact there is even StrictYAML with features removed."><meta itemprop="datePublished" content="2022-11-29T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-11-29T00:00:00+00:00" />
<meta itemprop="wordCount" content="756">
<meta itemprop="keywords" content="" />
  <meta property="og:title" content="A Detailed Comparison of YAML Formatters" />
<meta property="og:description" content="This is a survey of the current state of YAML formatters. For this blog post, I&rsquo;m comparing tools that take YAML files on disk and rewrite them to some standard. This is beyond the scope of a normal YAML linter.
If you ask me, all file formats deserve a fmt tool. YAML is not exception, especially as it is not the best. In fact there is even StrictYAML with features removed." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/A-Detailed-Comparison-of-YAML-Formatters/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-11-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-11-29T00:00:00+00:00" />


  
  <title>
    
    A Detailed Comparison of YAML Formatters | xkyle.com
    
  </title>
  <link rel="canonical" href="../A-Detailed-Comparison-of-YAML-Formatters/">
  <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
  <link rel="manifest" href="../site.webmanifest">
  
  
  
  
  
  
  
  
  <link rel="stylesheet" href="../css/base.min.24be1671072a4ffd1658d18782fbd46366c3ac77c8897688b09caf78e90fce23.css" integrity="sha256-JL4WcQcqT/0WWNGHgvvUY2bDrHfIiXaIsJyveOkPziM=" crossorigin="anonymous">
  
  
</head>
<body>
  <nav class="u-background">
  <div class="u-wrapper">
    <ul class="Banner">
      <li class="Banner-item Banner-item--title">
        <a class="Banner-link u-clickable" href="">xkyle.com</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="../about/">About</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="../post/">Posts</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="../categories/">Categories</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="../subscribe/">Subscribe</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="../"></a>
      </li>
      
      <li class="Banner-item">
<form action="https://www.google.com/search" class="Banner-link u-clickable" method="get" name="searchform" target="_blank">
<input name="sitesearch" type="hidden" value="xkyle.com">
<input autocomplete="on" class="form-control search2" name="q" placeholder="Search" required="required"  type="text" style="width: 50px;">
<button class="button" type="submit" style="width:1px;text-align: center;border-right-width: 20px;border-right-style: solid;height: 34px;">üîç</button>
</form>
      </li>
  </div>
</nav>

  <main>
    <div class="u-wrapper">
      <div class="u-padding">
        

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="../A-Detailed-Comparison-of-YAML-Formatters/" rel="bookmark">A Detailed Comparison of YAML Formatters</a>
  </h2>
  
  <time datetime="2022-11-29T00:00:00Z">
    29 November, 2022
  </time>
  
</header>

  <p>This is a survey of the current state of YAML formatters.
For this blog post, I&rsquo;m comparing tools that take YAML files on disk and rewrite them to some standard.
This is beyond the scope of a normal YAML linter.</p>
<p>If you ask me, all file formats deserve a <code>fmt</code> tool.
YAML is not exception, especially as it is <a href="https://www.arp242.net/yaml-config.html">not the best</a>.
In fact there is even <code>StrictYAML</code> with <a href="https://hitchdev.com/strictyaml/features-removed/">features removed</a>.
This isn&rsquo;t quite a <code>fmt</code> tool, but limiting the craziness you can put in a YAML file certainly makes it easier to format!</p>
<p>After looking these formatters, <strong><em>I think they still do not go far enough</em></strong>.
None of them block the <a href="https://hitchdev.com/strictyaml/why/implicit-typing-removed/">Norway problem</a>.
All of them (except Prettier) turn multiline complexity into multiline insanity.
Maybe someday I&rsquo;ll write my own YAML formatter, probably based on <code>StrictYAML</code>, that blocks nonsense and homogenizes <em>everything</em>.</p>
<p>Till then, if I missed a linter or missed a feature you are interested in, just [email me](<a href="mailto:kyle@xkyle.com">kyle@xkyle.com</a>?subject=YAML Formatters).
Or better yet make a <a href="https://github.com/solarkennedy/yaml-formatter-comparison">pull request on the code I used</a>.</p>
<h2 id="the-list">The List</h2>
<ul>
<li><a href="https://github.com/google/yamlfmt">Google (unofficial) yamlfmt</a>: Standalone tool for formatting YAML</li>
<li><a href="https://github.com/jumanjihouse/pre-commit-hook-yamlfmt">pre-commit-hook-yamlfmtl</a>: a hook for the <a href="http://pre-commit.com/">pre-commit</a> system</li>
<li><a href="https://pypi.org/project/yamlfmt/">Python yamlfmt</a>: A CLI wrapper around the <a href="https://pypi.org/project/ruamel.yaml/">python ruamel.yaml</a> library</li>
<li><a href="https://github.com/prettier/prettier">Prettier</a>: A general purpose formatting tool for many languages</li>
</ul>
<p>And here is a TLDR summary of the results given default settings:</p>
<table>
<thead>
<tr>
<th>Formatter</th>
<th>Google yamlfmt</th>
<th>Pre-commit yamlfmt</th>
<th>Python yamlfmt</th>
<th>Prettier</th>
</tr>
</thead>
<tbody>
<tr>
<td>Language</td>
<td>golang</td>
<td>python</td>
<td>python</td>
<td>nodejs</td>
</tr>
<tr>
<td>Preserves anchors</td>
<td>Yes (adds explicit <code>!!merge</code>)</td>
<td>Yes (misplaces comment)</td>
<td>Yes (misplaces comment)</td>
<td>Yes</td>
</tr>
<tr>
<td>Homogenizes horizontal whitespace</td>
<td>Yes (removed blank newlines)</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>Homogenizes indents?</td>
<td>Defaults to 2 spaces</td>
<td>Defaults to 4 spaces</td>
<td>Preserves original</td>
<td>2 spaces</td>
</tr>
<tr>
<td>Multiline strings? (already insane)</td>
<td>Converts newlines to <code>\n</code> unless using <code>&gt;</code></td>
<td>Adds <code>&quot;</code> and escapes with <code>\&quot;</code></td>
<td>Adds <code>&quot;</code> and escapes with <code>\&quot;</code></td>
<td>Preserves</td>
</tr>
<tr>
<td><code>---</code> Header?</td>
<td>Removes it</td>
<td>Adds it</td>
<td>Removes it</td>
<td>Preserves it</td>
</tr>
<tr>
<td><code>!!TYPE</code> explicit types</td>
<td>Preserves</td>
<td>Removes</td>
<td>Removes</td>
<td>Preserves</td>
</tr>
</tbody>
</table>
<p>None of the formatters had features I wanted:</p>
<ul>
<li>Homogenize bools (no more <code>NO</code>s)</li>
<li>Normalize nulls (no more emptiness being null or <code>~</code>)</li>
<li>Normalize date formats</li>
<li>Normalize floats</li>
<li>Normalize hex strings</li>
</ul>
<p>I guess I mostly want something that morphs YAML&rsquo;s leniency into whatever JSON has as its final representation.</p>
<h2 id="input">Input</h2>
<p>See the <a href="https://github.com/solarkennedy/yaml-formatter-comparison/blob/master/in.yaml">input file here</a>.
I tried to add as many weird things in there as possible, to exercise the formatters to their maximum.</p>
<h2 id="results">Results</h2>
<h3 id="google-yamlfmt">Google yamlfmt</h3>
<p>Google yamlfmt produced some of them most opinionated outputs, but is also the most configurable.
It has the <em>potential</em> to be the formatter I want, I think it just needs a special <code>kyle</code> formatter instead of the <a href="https://github.com/google/yamlfmt/tree/main/formatters/basic">basic</a> one :).
Still, the fact that it removes horizontal whitespace seems weird to me (Defaults with <code>retain_line_breaks: false</code>).
I think line breaks should be preserved, but multiple line breaks should be normalized to 1 (Prettier&rsquo;s behavior).</p>
<p>There is also something to be said about a golang tool that can be installed via a binary.
I appreciate that the Google yamlfmt tool doesn&rsquo;t impose installing &hellip; anything except itself (no npm, node, python, etc).</p>
<h3 id="pre-commit-yamlfmt">Pre-commit yamlfmt</h3>
<p>The Pre-commit yamlfmt tool is designed to be used with the <a href="http://pre-commit.com/">pre-commit</a> ecosystem, but it can be used in a standalone way.
It has some configuration, with the current defaults:</p>
<pre><code>mapping: 4 spaces
sequence: 6 spaces
offset: 4 spaces
colons: do not align top-level colons
width: None (use ruamel default)
</code></pre>
<h3 id="python-yamlfmt">Python yamlfmt</h3>
<p>This standalone python script has no configuration.
In some sense it is the <em>most</em> opinionated tool!
Yet in a different way, it did the <em>least</em> actual formatting.</p>
<h3 id="prettier">Prettier</h3>
<p>Prettier is a general purpose formatting tool.
If your needs extend past YAML and include other formats, it may be worth it to just use one tool (Prettier), if you don&rsquo;t mind install node/npm.</p>
<p>Prettier is also very opinionated (very few options), and it does impose some of those opinions.</p>
<h2 id="conclusion">Conclusion</h2>
<p>My preference is for google yamlfmt.
After working with Python professionally, I&rsquo;m tired of fighting Python interpreters and pip.
I also lost little faith after these python yaml <a href="https://www.cvedetails.com/cve/CVE-2019-20478/">code execution</a> <a href="https://www.cvedetails.com/cve/CVE-2020-14343/">vulnerabilities</a>.
(Ruby is <a href="https://www.sitepoint.com/anatomy-of-an-exploit-an-in-depth-look-at-the-rails-yaml-vulnerability/">not immune</a>)
I do appreciate Prettier.
If you need to format lots of different stuff in one project, it might be easier to let prettier do it all.</p>
<p>YAML is in a weird position where it&rsquo;s desire to be human-friendly leads to weirdness.
Its flexibility is its downside, and its not opinionated enough in the right places to prevent more mistakes.</p>
<p>Till then, as with all file formats, I&rsquo;m happy for any computer-enforced style guide (aka a <code>fmt</code> tool).
I hope this review inspires you to adopt one, any one.</p>

  

  







  <a href="mailto:kyle@xkyle.com?subject=Comment on: A%20Detailed%20Comparison%20of%20YAML%20Formatters">Comment via email</a>

</article>


      </div>
    </div>
  </main>
  

</body>
</html>
